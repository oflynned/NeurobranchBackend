<div id="page-content-wrapper dashboard">
    <div class="container-fluid content-main">
        <div class="row">
            <div class="col-lg-12">
                <!-- title -->
                <div class="page-header">
                    <h3>{{trial.title}}</h3>
                </div>
            </div>
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

        <script src="https://d3js.org/d3.v4.js"></script>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="https://d3js.org/d3-selection.v1.js"></script>



        <!-- container for holding trial data -->
        <div id="dashboard-content-holder">
            <div class="row text-center">
                <div class="col-md-6">
                    <!-- images for the trial -->
                    <img src="{{multimedia}}">
                </div>
                <div class="col-md-6 text-left">
                    <div><strong>Condition:</strong> {{trial.condition}}</div>
                    <div><strong>Type:</strong> {{trial.trialtype}}</div>
                    <div><strong>Institute:</strong> {{trial.institute}}</div>
                    <div><strong>Date Created:</strong> {{trial.datecreated}}</div>
                    {{#if trial.datestarted}}
                        <div><strong>Date Started:</strong> {{trial.datestarted}}</div>
                    {{/if}}
                    {{#if trial.dateended}}
                        <div><strong>Date Ended:</strong> {{trial.dateended}}</div>
                    {{/if}}
                    <br>
                    <div><strong>State:</strong> {{trial.state}}</div>
                    <div><strong>Trial Duration:</strong> {{trial.duration}}</div>
                    <div><strong>Candidate Quota:</strong> {{trial.candidatequota}}</div>
                    <div><strong>Question Frequency:</strong> {{trial.frequency}}</div>
                    <br>
                    <div>{{trial.briefdescription}}</div>

                    <button class="btn btn-primary">Publish Trial</button>
                    <button class="btn btn-success" disabled>Trial Active</button>
                    <button class="btn btn-danger">Cancel Trial</button>

                </div>
            </div>

            <div class="row text-left">
                <div class="col-md-6">
                    <!-- about -->
                    <div class="page-header"><h3>About the trial</h3></div>
                    <div>{{trial.detaileddescription}}</div>
                </div>

                <div class="col-md-6">
                    {{#if is_researcher}}
                        <div class="page-header">
                            <h3>Questions</h3>
                        </div>

                        <ol>
                            {{#each questions}}
                                <li><strong>Title:</strong> {{title}}</li>
                                <strong>Type:</strong> {{questiontype}}
                                <ol>
                                    {{#each answers}}
                                        <li>
                                            {{this}}
                                        </li>
                                    {{/each}}
                                </ol>
                            {{/each}}
                        </ol>
                    {{else}}
                        <div>
                            Please sign in as this researcher in order to see more details
                        </div>
                    {{/if}}
                </div>
            </div>

            {{#if is_researcher}}
                <div class="page-header">
                    <h3>Statistics</h3>
                </div>
                <div>
                    <p>here everywhere
                    </p>

                    <script>
                        var dataArray= [10, 20 , 40 , 420, 90]

                        var width = 500;
                        var height = 500;

                        var widthScale = d3.scaleLinear().domain([0,60]).range([0,width]);
                        var color = d3.scaleLinear().domain([0,60]).range(["red","blue"]);

                        var canvas = d3.select("p")
                                .append("svg")
                                .attr("width",width)
                                .attr("height", height);


                        var bars = canvas.selectAll("rect")
                                .data(dataArray)
                                .enter()
                                .append("rect")
                                .attr("width", function(d){return widthScale(d);})
                                .attr("height", 50)
                                .attr("fill", function(d){return color(d);})
                                .attr("y",function(d,i){return i*100});

                    </script>


                    {{#if statistics}}
                        Responses & graphs here
                    {{else}}
                        {{#if trial.datestarted}}
                            No data is currently available for this trial
                        {{else}}
                            No data is currently available for this trial as it hasn't been started yet.
                            Your trial currently has <strong>0</strong> verified candidates, and requires a
                            minimum of <strong>{{trial.candidatequota}}</strong> to be started.<br>
                            Please view the notifications section in the side bar in order to manage candidate
                            verification.
                        {{/if}}
                    {{/if}}
                </div>
            {{else}}
                <div>
                    Please sign in as this researcher in order to see more details
                </div>
            {{/if}}
        </div>
        <!-- stats -->
        <div class="row">
            <div class="col-md-6">
                <div class="page-header">
                    <h3>Candidate Requests</h3>
                </div>
                {{#if is_researcher}}
                    {{#if req_candidates}}
                        <ol>
                            {{#each req_candidates}}
                                <div class="row">
                                    <li><a href="/users/candidates/{{userid}}/{{../trial._id}}">{{userid}}</a>
                                        <form id="form_verify_{{userid}}"
                                              action="/api/create-verified-candidate/trialid/{{../trial._id}}/candidateid/{{userid}}"
                                              method="post">
                                            <button id="ver_{{userid}}" class="btn btn-success">
                                                Verify
                                            </button>
                                        </form>
                                        <form id="form_delete_{{userid}}"
                                              action="/api/remove-requested-candidate/trialid/{{../trial._id}}/candidateid/{{userid}}"
                                              method="post">
                                            <button id="del_{{userid}}" class="btn btn-danger">
                                                Remove
                                            </button>
                                        </form>
                                    </li>
                                </div>
                            {{/each}}
                        </ol>
                    {{else}}
                        <div>
                            No candidates have currently requested to join this trial
                        </div>
                    {{/if}}
                {{else}}
                    <div>
                        Please sign in as this researcher in order to see more details
                    </div>
                {{/if}}
            </div>
            <div class="col-md-6 text-left">
                <div class="page-header">
                    <h3>Verified Candidates</h3>
                </div>
                {{#if is_researcher}}
                    <ul>
                        {{#each ver_candidates}}
                            <li><a href="/users/candidates/{{userid}}/{{../trial._id}}">{{userid}}</a></li>
                        {{/each}}
                    </ul>
                {{else}}
                    <div>
                        Please sign in as this researcher in order to see more details
                    </div>
                {{/if}}
            </div>
        </div>
    </div>
</div>